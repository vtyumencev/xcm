(function(){"use strict";let v=()=>({emit(t,...e){for(let s=this.events[t]||[],n=0,o=s.length;n<o;n++)s[n](...e)},events:{},on(t,e){var s;return((s=this.events)[t]||(s[t]=[])).push(e),()=>{var n;this.events[t]=(n=this.events[t])==null?void 0:n.filter(o=>e!==o)}}});var S=Object.defineProperty,y=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,b=(t,e,s)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,d=(t,e)=>{for(var s in e||(e={}))k.call(e,s)&&b(t,s,e[s]);if(y)for(var s of y(e))M.call(e,s)&&b(t,s,e[s]);return t},T=(t,e,s)=>new Promise((n,o)=>{var a=r=>{try{g(s.next(r))}catch(p){o(p)}},i=r=>{try{g(s.throw(r))}catch(p){o(p)}},g=r=>r.done?n(r.value):Promise.resolve(r.value).then(a,i);g((s=s.apply(t,e)).next())}),O=class{constructor(){this.isInitialized=!1,this.BASE_Z_INDEX=100,this.TAB_QUERY_SELECTORS='a[href]:not([disabled]),button:not([disabled]),textarea:not([disabled]),input[type="submit"]:not([disabled]),input[type="text"]:not([disabled]),input[type="radio"]:not([disabled]),input[type="checkbox"]:not([disabled]),select:not([disabled])',this.modalsEnabled=!1,this.hookOptionsList=[],this.connectedModules=[],this.modals=[],this.emitter=v(),document.addEventListener("DOMContentLoaded",this.updateScrollbarBuffer),window.addEventListener("resize",this.updateScrollbarBuffer)}on(t,e){return this.emitter.on(t,e)}updateScrollbarBuffer(){const t=document.createElement("div");t.style.visibility="hidden",t.style.overflow="scroll",document.body.appendChild(t);const e=document.createElement("div");t.appendChild(e);const s=t.offsetWidth-e.offsetWidth;t.parentNode.removeChild(t),document.body.style.setProperty("--scroll-bar-buffer",s+"px")}openModal(t){return T(this,arguments,function*(e,s={}){for(const i of this.modals)if(i.el===e)return;let o=d({},{closable:!0,onOpening:null,onOpen:null,onClosing:null,onClose:null,transitionDuration:300});for(const i of this.hookOptionsList)i.modalId===e.getAttribute("id")&&(o=d(d({},o),i.options));if(o=d(d({},o),s),e.style.zIndex=(this.BASE_Z_INDEX+this.modals.length).toString(),e.setAttribute("tabindex","-1"),e.classList.add("showing"),e.classList.add("shown"),o.onOpening){let i=!1;setTimeout(()=>{i||e.classList.add("loading")},20),yield o.onOpening(e).catch(()=>{throw e.classList.remove("loading"),e.classList.remove("shown"),e.classList.remove("showing"),new Error("Impossible to create a modal window with an opening callback: "+o.onOpening)}),i=!0,e.classList.remove("loading")}e.querySelector(".sx-modal-dialog").clientHeight>window.innerHeight?e.classList.add("scrollable"):e.classList.remove("scrollable"),e.offsetWidth,e.classList.add("visible"),setTimeout(()=>{var i;e.classList.add("released"),e.classList.remove("showing"),(i=e.querySelectorAll(this.TAB_QUERY_SELECTORS)[0])==null||i.focus()},o.transitionDuration+100);const a=[];e.querySelectorAll(".js-action-close").forEach(i=>{a.push({el:i,name:"click",callback:this.destroyModalClickEvent.bind(this)})}),a.push({el:e,name:"click",callback:this.onDocumentClick.bind(this)}),a.push({el:e,name:"keydown",callback:this.onKeyEvent.bind(this)});for(const i of a)i.el.addEventListener(i.name,i.callback);this.modals.push({previousActiveElement:document.activeElement,el:e,options:o,events:a}),this.updateModals()})}destroyModal(t){const e={modal:t,callback:()=>{const s=t.el;s.classList.add("hiding"),s.classList.remove("visible"),s.classList.remove("released"),setTimeout(()=>{var n;s.classList.remove("shown"),s.classList.remove("hiding"),(n=t.previousActiveElement)==null||n.focus(),this.updateModals()},t.options.transitionDuration);for(const n of t.events)n.el.removeEventListener(n.name,n.callback);t.options.onClose&&t.options.onClose(s),this.modals=this.modals.filter(n=>s!==n.el)}};this.emitter.emit("dialogDestroying",e),e.callback()}onDocumentClick(t){t.target.closest(".js-sx-modal-dialog-body")||this.modals[this.modals.length-1].options.closable===!0&&this.destroyModal(this.modals[this.modals.length-1])}onKeyEvent(t){if(t.key==="Escape"&&this.modals[this.modals.length-1].options.closable===!0){this.destroyModal(this.modals[this.modals.length-1]);return}const e=this.modals[this.modals.length-1].el.querySelectorAll(this.TAB_QUERY_SELECTORS),s=e[0],n=e[e.length-1];t.key==="Tab"&&(this.modals[this.modals.length-1].el.contains(document.activeElement)?t.shiftKey?document.activeElement===s&&(n.focus(),t.preventDefault()):document.activeElement===n&&(s.focus(),t.preventDefault()):(s&&s.focus(),t.preventDefault()))}destroyModalClickEvent(t){const e=t.target.closest(".sx-modal"),s=this.modals.find(n=>e===n.el);s&&this.destroyModal(s)}updateModals(){if(this.modals.length>0){if(this.modalsEnabled)return;this.modalsEnabled=!0,document.body.classList.add("has-active-sx-modal")}else{if(!this.modalsEnabled)return;this.modalsEnabled=!1,document.body.classList.remove("has-active-sx-modal")}}start(t){if(this.isInitialized)return console.warn("SXModal: Already initialized"),this;this.keyDownEvent=this.onKeyEvent.bind(this);for(const e of t??[]){const s=new e(this);s.modalInit(),this.connectedModules.push(s)}this.isInitialized=!0}addOptionsHook(t,e){this.hookOptionsList.push({modalId:t,options:e})}init(t,e={}){let s;t instanceof HTMLElement?s=t:typeof t=="string"&&(s=document.querySelector(t)),s&&this.openModal(s,e)}destroy(t){let e;if(t instanceof HTMLElement?e=t:typeof t=="string"&&(e=document.querySelector(t)),!!e)for(const s of this.modals)s.el===e&&this.destroyModal(s)}},u=new O;const m="js-xcm-manager-category-review";let l,h,c;const A=t=>{const e=c.getUserConfig();for(const s of Object.entries(e.consent))if(t.consent[s[0]]===!0&&s[1]===!1)return!0;return!1},w=t=>{t.target.closest(`.${m}`).classList.contains("active")?t.target.closest(`.${m}`).classList.remove("active"):t.target.closest(`.${m}`).classList.add("active")},C=t=>{const e=t.target.getAttribute("data-vendor-id"),s=_("xcm-modal-vendor");document.body.appendChild(s),u.init(s,{onOpening:async()=>{await fetch(window.XCMSettingsPublic.ajaxUrl+"?action=xcm_vendor&vendorId="+e,{}).then(n=>n.text()).then(n=>{s.querySelector(".sx-modal-dialog__content").innerHTML=n})},onClose:()=>{setTimeout(()=>{s.remove()},500)}})},L=async t=>{t.preventDefault(),t.submitter.getAttribute("data-action")==="accept-all"&&t.target.querySelectorAll(".xcm-manager-category-switch input").forEach(s=>{s.checked=!0}),setTimeout(()=>{u.destroy(l)},100);const e=c.getUserConfig();await fetch(window.XCMSettingsPublic.ajaxUrl+"?action=xcm_update",{method:"POST",body:new FormData(t.target)}).then(s=>s.json()),e&&A(e)&&window.location.reload(),c.emit("consentUpdated")},P=(t,e=null)=>{if(t.querySelectorAll(".js-xcm-manager-category-toggle").forEach(s=>{s.addEventListener("click",w)}),t.querySelectorAll(".js-xcm-vendor-review").forEach(s=>{s.addEventListener("click",C)}),e){const s=t.querySelector(`.xcm-manager-category[data-id="${e}"]`);s&&setTimeout(()=>{s.classList.add("active"),s.scrollIntoView({behavior:"smooth"})},500)}t.querySelector(".js-xcm-manager-form").addEventListener("submit",L)},U=t=>{t.querySelectorAll(".js-xcm-manager-category-toggle").forEach(e=>{e.removeEventListener("click",w)}),t.querySelectorAll(".js-xcm-vendor-review").forEach(e=>{e.removeEventListener("click",C)}),t.querySelector(".js-xcm-manager-form").removeEventListener("submit",L)},_=t=>{const e=document.createElement("div");return e.classList.add("sx-modal"),e.classList.add("xcm-modal"),e.setAttribute("id",t),e.innerHTML=`
            <div class="sx-modal__inner">
                <div class="sx-modal-dialog__bg"></div>
                <div class="sx-modal-dialog modal-dialog--lg">
                    <div class="sx-modal-dialog__container">
                        <div class="sx-modal-dialog__body js-sx-modal-dialog-body">
                            <div class="sx-modal-dialog__content"></div>
                        </div>
                    </div>
                </div>
                <div class="sx-modal-loading">
                    <div class="sx-modal-loading__body">
                        Wird geladen...
                    </div>
                </div>
            </div>`,document.body.appendChild(e),e},j=(()=>{const t=async()=>await fetch(window.XCMSettingsPublic.ajaxUrl+"?action=xcm_overview",{}).then(e=>e.text()).then(e=>e);return{show(e=!0,s=null){let n=new Promise(o=>o(!0));l||(l=_("xenio-consent-modal"),h=l.querySelector(".sx-modal-dialog__content"),document.body.appendChild(l),n=new Promise(async o=>{h.innerHTML=await t(),o(!0)})),u.init(l,{onOpening:async()=>{await n,P(h,s)},onClose:()=>{U(h)},closable:e})},start(e){c=e,window.addEventListener("popstate",()=>{if(window.location.hash.startsWith("#consent-overview")){const s=window.location.hash.match(/#consent-overview\.cat\.(\d*)/),n=s&&(parseInt(s[1])??null);this.show(!0,n)}}),window.addEventListener("DOMContentLoaded",()=>{c.getUserConfig()?c.prolongConfig():this.show(!1)},{once:!0})}}})(),D=(()=>{let t;const e=window.dataLayer=window.dataLayer||[];function s(...o){e.push(arguments)}const n={ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",analytics_storage:"denied"};return{start(o){t=o,s("consent","default",Object.assign(n,t.getConsentConsentsTypes())),t.getUserConfig()&&s("event","update_consent"),t.on("consentUpdated",()=>{this.update()})},update(){s("consent","update",Object.assign(n,t.getConsentConsentsTypes())),s("event","update_consent")}}})(),x=v(),I=(t,e,s)=>{const n=new Date;n.setTime(n.getTime()+s*24*60*60*1e3);let o="expires="+n.toUTCString();document.cookie=t+"="+e+";"+o+";path=/"},R=t=>{let e=t+"=",s=document.cookie.split(";");for(let n=0;n<s.length;n++){let o=s[n];for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(e)===0)return o.substring(e.length,o.length)}return""},f=(()=>{const t=window.XCMSettingsPublic;return{on(e,s){return x.on(e,s)},emit(e,...s){return x.emit(e,...s)},getUserConfig(){let e;try{const s=R("xcm");e=JSON.parse(decodeURIComponent(s))}catch{}return e},prolongConfig(){I("xcm",encodeURIComponent(JSON.stringify(this.getUserConfig())),365)},getConsentConsentsTypes(){var n;const e=this.getUserConfig(),s={};if(!(e!=null&&e.consent))return s;for(const o of t.categories){if(!e.consent[o.id])continue;const a=((n=o.consent_types)==null?void 0:n.split(","))??[];for(const i of a)s[i]="granted"}return s},isProviderBlocked(e){const s=this.getUserConfig();for(const n of t.categories)if(!(s!=null&&s.consent[n.id])){for(const o of n.vendors)if(n.necessary==="0"&&o.provider&&e.includes(o.provider))return{provider:o.provider,category_id:n.id,category_name:n.name}}return!1}}})(),q=()=>{let t;const e=()=>{document.querySelectorAll(".xcm-embed-replacer").forEach(s=>{if(!t.isProviderBlocked(s.getAttribute("data-provider"))){const n=B(s.getAttribute("data-origin"));E(n),s.after(n),s.remove()}})};return{start(s){t=s,document.addEventListener("DOMContentLoaded",()=>{e()}),t.on("consentUpdated",()=>{e()})}}};function B(t,e=!0){if(t=e?t.trim():t,!t)return null;const s=document.createElement("template");return s.innerHTML=t,s.content.children[0]}function E(t){if(N(t)===!0)t.parentNode.replaceChild(H(t),t);else{let e=-1,s=t.childNodes;for(;++e<s.length;)E(s[e])}return t}function H(t){const e=document.createElement("script");e.text=t.innerHTML;let s=-1,n=t.attributes,o;for(;++s<n.length;)e.setAttribute((o=n[s]).name,o.value);return e}function N(t){return t.tagName==="SCRIPT"}const z=q();u.start(),D.start(f),j.start(f),z.start(f)})();
